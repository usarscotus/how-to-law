---
import BaseLayout from '~/layouts/BaseLayout.astro';
import { glossaryTerms } from '~/lib/utils';

const terms = [...glossaryTerms].sort((a, b) => a.term.localeCompare(b.term));
const grouped = terms.reduce((acc, term) => {
  const key = term.term.charAt(0).toUpperCase();
  acc[key] = acc[key] ?? [];
  acc[key].push(term);
  return acc;
}, {} as Record<string, typeof terms>);
const letters = Object.keys(grouped).sort();
---
<BaseLayout
  title="Glossary"
  description="Definitions of key legal concepts referenced throughout the How to Law classroom."
>
  <section class="bg-background">
    <div class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8">
      <header class="space-y-4">
        <p class="text-sm font-semibold uppercase tracking-wide text-accent">Key terms</p>
        <h1 class="text-3xl font-semibold tracking-tight text-foreground sm:text-4xl">Glossary</h1>
        <p class="text-lg text-foreground/75">
          The glossary provides quick definitions and context for the doctrines, procedures, and institutions referenced in each lesson.
          Select a term to jump directly to its entry.
        </p>
      </header>
      <nav aria-label="Glossary index" class="mt-10 flex flex-wrap gap-2 text-sm font-semibold">
        {letters.map((letter) => (
          <a
            href={`#letter-${letter}`}
            class="rounded-full border border-border px-3 py-1 text-foreground transition hover:border-accent/60 focus:outline-none focus-visible:ring-2 focus-visible:ring-accent"
          >
            {letter}
          </a>
        ))}
      </nav>
      <div class="mt-12 space-y-12">
        {letters.map((letter) => (
          <section id={`letter-${letter}`} class="space-y-4">
            <h2 class="text-2xl font-semibold text-foreground">{letter}</h2>
            <dl class="space-y-6">
              {grouped[letter].map((term) => (
                <div id={term.id} class="rounded-2xl border border-border bg-card p-5 shadow-subtle">
                  <dt class="text-lg font-semibold text-foreground">{term.term}</dt>
                  <dd class="mt-2 text-sm text-foreground/80">{term.def}</dd>
                </div>
              ))}
            </dl>
          </section>
        ))}
      </div>
    </div>
  </section>
</BaseLayout>
